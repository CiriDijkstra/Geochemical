# Geochemical
Used to deal with geochemical data.
该程序主要用于做一些简单的化探数据预处理，包括通过逐步截尾法剔除离群点、对元素含量进行正态检验、计算元素含量的背景上限、计算样品的变差衬度值等。

0. 需要事先做好的准备工作：

	（1）环境配置：python 3.6

		       python包：numpy 1.14.2

				 openpyxl 2.5.2

				 scipy 1.0.1

	（2）将原始数据文件命名为“samples.xlsx”，存储在程序主目录下（即main.py文件所在的目录）

	     将sample.xlsx中变量名存储在第一行，将高斯坐标X、Y坐标的变量名存储为“XX”和“YY”；

	     将各元素含量的变量名存储为该元素的符号，如W、Sn、Au等；

	     将类标号的变量名存储为“class”。

1. 程序从main.py启动,运行后程序自动从samples.xlsx读取原始数据，并将输出两个表格文件：

	（1）分类情况.xlsx  存储了各个分区的样品数量，各元素在各个分类的分布模型（正态分布或对数正态分布）以及背景上限值；

	（2）变差衬度值.xlsx  存储每个样品的经纬度坐标和元素变差衬度值，用于后续工作如网格化、作等值线图。

2. 辅助模块包括Element.py和Sample.py，每个模块里分别定义了一个类（ElementList类和Sample类），简要说明每个类的用途，详细说明可以参阅源代码中的注释

	（1）ElementList：继承自list类，用一个列表存储一系列元素含量，在list类的基础上增加了实例域element_name，用于存储元素名称；

	     实例方法robust_data：用逐步截尾法剔除离群点，可以指定参数：k，置信区间为[C - k*S, C + k*S]，若不指定则取默认值2，返回剔除离群点后的元素含量列表；

	     实例方法distribution_pattern：用K-S值检验元素含量的分布模型，返回字符串'norm'或'lognorm'分别代表正态分布或对数正态分布；

	     实例方法c_a：计算一个元素序列的背景上限，根据不同的分布模式采用不同的公式（正态分布或对数正态分布）；参数：k，指定背景上限取C+k*S，默认为2；返回背景上限值。
	
	（2）Sample：Sample类的实例用于存储一个样品的一些信息，包括：样品号、元素含量（微量成矿元素、造岩元素）、成矿元素的“变差衬度值”、经纬度坐标和分类标号
	     
             实例方法dist：计算两个样品的造岩元素含量之间欧氏距离，可以用于作聚类分析；
          
             实例方法describe_sample：输出一个样品的一些描述信息，包括样品号、经纬度坐标、元素含量和类标号等；
 
             实例方法is_adjacency：判断两个样品在经纬度网格上是否相邻（网格化后的坐标有8个相邻点）。
